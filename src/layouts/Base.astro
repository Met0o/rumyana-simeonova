---
const {
  title = 'Rumyana Simeonova | Therapist in Training',
  description = 'Therapy practice updates, resources, and booking information for clients working with Rumyana Simeonova.',
  canonical,
  pageType = 'website',
} = Astro.props;

const navLinks = [
  { href: '/', label: 'Home', match: (path) => path === '/' },
  { href: '/about/', label: 'About' },
  { href: '/services/', label: 'Services' },
  { href: '/booking/', label: 'Booking' },
  { href: '/blog/', label: 'Blog', match: (path) => path.startsWith('/blog') },
  { href: '/contact/', label: 'Contact' },
];

const normalize = (value) => value.replace(/\/+$/, '') || '/';
const currentPath = normalize(Astro.url.pathname);
const resolvedCanonical =
  canonical ?? (Astro.site ? new URL(Astro.url.pathname, Astro.site).toString() : undefined);
const currentYear = new Date().getFullYear();
---
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    {resolvedCanonical && <link rel="canonical" href={resolvedCanonical} />}
    <link rel="icon" href="/favicon.ico" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    {resolvedCanonical && <meta property="og:url" content={resolvedCanonical} />}
    <meta property="og:type" content={pageType} />
    <meta name="twitter:card" content="summary" />
    <style>
      :root {
        color-scheme: dark;
        --max-width: 880px;
        --accent: #a99dff;
        --text: #f5f4ff;
        --muted: #b8b3d2;
        --surface: #1f1b33;
        --surface-muted: #2a2542;
        --background: #141024;
      }
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        line-height: 1.6;
        color: var(--text);
        background: var(--background);
      }
      a {
        color: var(--accent);
      }
      .skip-link {
        position: absolute;
        left: -999px;
        top: auto;
        width: 1px;
        height: 1px;
        overflow: hidden;
      }
      .skip-link:focus {
        left: 1rem;
        top: 1rem;
        width: auto;
        height: auto;
        padding: 0.5rem 0.75rem;
        background: var(--surface);
        color: var(--text);
        border: 2px solid var(--accent);
        border-radius: 0.5rem;
        z-index: 999;
      }
      header {
        background: var(--surface);
        border-bottom: 1px solid rgba(169, 157, 255, 0.2);
      }
      .wrap {
        max-width: var(--max-width);
        margin: 0 auto;
        padding: 0 1.25rem;
      }
      .header-inner {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 1rem;
        padding: 1.5rem 0;
      }
      .brand a {
        text-decoration: none;
        color: inherit;
        display: inline-flex;
        flex-direction: column;
        gap: 0.1rem;
      }
      .site-name {
        font-size: 1.25rem;
        font-weight: 700;
        letter-spacing: -0.01em;
      }
      .tagline {
        font-size: 0.95rem;
        color: var(--muted);
      }
      nav ul {
        list-style: none;
        display: flex;
        align-items: center;
        margin: 0;
        padding: 0;
        gap: 1rem;
        flex-wrap: wrap;
      }
      nav a {
        text-decoration: none;
        font-weight: 500;
        padding: 0.35rem 0;
        border-bottom: 2px solid transparent;
        color: var(--muted);
      }
      nav a:hover,
      nav a:focus-visible {
        color: var(--text);
        border-color: rgba(169, 157, 255, 0.4);
      }
      nav a[aria-current='page'] {
        color: var(--text);
        border-color: var(--accent);
      }
      main {
        padding: 2.5rem 0 3rem;
      }
      footer {
        background: var(--surface-muted);
        border-top: 1px solid rgba(169, 157, 255, 0.15);
        padding: 2rem 0;
        font-size: 0.95rem;
        color: var(--muted);
      }
      footer a {
        color: inherit;
      }
      footer nav ul {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
      }
      @media (max-width: 600px) {
        .header-inner {
          flex-direction: column;
          align-items: flex-start;
        }
        nav ul {
          gap: 0.75rem;
        }
      }
    </style>
  </head>
  <body>
    <a class="skip-link" href="#main">Skip to content</a>
    <header>
      <div class="wrap header-inner">
        <div class="brand">
          <a href="/" aria-label="Rumyana Simeonova home">
            <span class="site-name">Rumyana Simeonova</span>
            <span class="tagline">Therapist in training</span>
          </a>
        </div>
        <nav aria-label="Primary">
          <ul>
            {navLinks.map((link) => {
              const isActive = link.match
                ? link.match(currentPath)
                : currentPath === normalize(link.href);
              return (
                <li>
                  <a href={link.href} aria-current={isActive ? 'page' : undefined}>
                    {link.label}
                  </a>
                </li>
              );
            })}
          </ul>
        </nav>
      </div>
    </header>
    <main id="main">
      <div class="wrap">
        <slot />
      </div>
    </main>
    <footer>
      <div class="wrap">
        <p>Â© {currentYear} Rumyana Simeonova. All rights reserved.</p>
        <nav aria-label="Legal">
          <ul>
            <li><a href="/privacy/">Privacy</a></li>
            <li><a href="/terms/">Terms</a></li>
          </ul>
        </nav>
      </div>
    </footer>
  </body>
</html>
